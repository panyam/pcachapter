<svg width="800" height="550" viewBox="0 0 800 550" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="dataGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#667eea;stop-opacity:0.1" />
      <stop offset="100%" style="stop-color:#764ba2;stop-opacity:0.2" />
    </linearGradient>
    <linearGradient id="speedGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f093fb;stop-opacity:0.1" />
      <stop offset="100%" style="stop-color:#f5576c;stop-opacity:0.2" />
    </linearGradient>
    <linearGradient id="batchGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4facfe;stop-opacity:0.1" />
      <stop offset="100%" style="stop-color:#00f2fe;stop-opacity:0.2" />
    </linearGradient>
    <linearGradient id="servingGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#00b894;stop-opacity:0.1" />
      <stop offset="100%" style="stop-color:#00a085;stop-opacity:0.2" />
    </linearGradient>
  </defs>
  
  <!-- Title -->
  <text x="400" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#333">
    Pattern 5: Lambda Architecture for Real-Time and Batch PCA
  </text>
  
  <!-- Sensor Data Streams (Top) -->
  <g>
    <rect x="300" y="60" width="200" height="60" fill="url(#dataGrad)" stroke="#667eea" stroke-width="2" rx="10"/>
    <text x="400" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#333">Sensor Data Streams</text>
    <text x="400" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#555">Coffee Shop IoT Sensors</text>
  </g>
  
  <!-- Speed Layer (Left) -->
  <g>
    <rect x="50" y="180" width="250" height="140" fill="url(#speedGrad)" stroke="#f5576c" stroke-width="2" rx="12"/>
    <text x="175" y="205" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#333">Speed Layer</text>
    <text x="175" y="220" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666">(Real-Time Processing)</text>
    
    <g font-family="Arial, sans-serif" font-size="11" fill="#555">
      <text x="65" y="245">• Real-time streaming</text>
      <text x="65" y="260">• 5-minute windows</text>
      <text x="65" y="275">• Anomaly PCA detection</text>
      <text x="65" y="290">• Immediate alerts</text>
      <text x="65" y="305">• Equipment failure detection</text>
    </g>
  </g>
  
  <!-- Batch Layer (Right) -->
  <g>
    <rect x="500" y="180" width="250" height="140" fill="url(#batchGrad)" stroke="#00f2fe" stroke-width="2" rx="12"/>
    <text x="625" y="205" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#333">Batch Layer</text>
    <text x="625" y="220" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666">(Historical Processing)</text>
    
    <g font-family="Arial, sans-serif" font-size="11" fill="#555">
      <text x="515" y="245">• Historical data store</text>
      <text x="515" y="260">• Monthly aggregation</text>
      <text x="515" y="275">• Complete PCA analysis</text>
      <text x="515" y="290">• Optimization insights</text>
      <text x="515" y="305">• Sensor redundancy analysis</text>
    </g>
  </g>
  
  <!-- Serving Layer (Bottom) -->
  <g>
    <rect x="250" y="380" width="300" height="100" fill="url(#servingGrad)" stroke="#00b894" stroke-width="2" rx="12"/>
    <text x="400" y="405" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#333">Serving Layer</text>
    <text x="400" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666">(Unified Query Interface)</text>
    
    <g font-family="Arial, sans-serif" font-size="11" fill="#555">
      <text x="265" y="445">• Unified view of real-time + historical data</text>
      <text x="265" y="460">• Maya's operations dashboard</text>
      <text x="265" y="475">• API access for business intelligence</text>
    </g>
  </g>
  
  <!-- Data flow arrows -->
  <g>
    <!-- From Sensor Data to Speed Layer -->
    <path d="M 350 120 L 200 180" stroke="#f5576c" stroke-width="3" marker-end="url(#speedArrow)"/>
    <text x="275" y="145" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#f5576c" transform="rotate(-25 275 145)">
      Real-time stream
    </text>
    
    <!-- From Sensor Data to Batch Layer -->
    <path d="M 450 120 L 600 180" stroke="#00f2fe" stroke-width="3" marker-end="url(#batchArrow)"/>
    <text x="525" y="145" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#00f2fe" transform="rotate(25 525 145)">
      Batch ingestion
    </text>
    
    <!-- From Speed Layer to Serving Layer -->
    <path d="M 175 320 L 320 380" stroke="#f5576c" stroke-width="2" stroke-dasharray="4,4" marker-end="url(#speedArrow)"/>
    
    <!-- From Batch Layer to Serving Layer -->
    <path d="M 625 320 L 480 380" stroke="#00f2fe" stroke-width="2" stroke-dasharray="4,4" marker-end="url(#batchArrow)"/>
  </g>
  
  <!-- Processing examples -->
  <g>
    <!-- Speed Layer Example -->
    <rect x="60" y="340" width="230" height="25" fill="#fff2f2" stroke="#f5576c" stroke-width="1" rx="5"/>
    <text x="175" y="355" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">
      Example: "All temp sensors showing identical readings - alert!"
    </text>
    
    <!-- Batch Layer Example -->
    <rect x="510" y="340" width="230" height="25" fill="#f0f9ff" stroke="#00f2fe" stroke-width="1" rx="5"/>
    <text x="625" y="355" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">
      Example: "Reduce from 20 to 5 sensors while preserving 85% variance"
    </text>
  </g>
  
  <!-- Multi-cloud services note -->
  <rect x="50" y="500" width="700" height="35" fill="#f8f9fa" stroke="#dee2e6" stroke-width="1" rx="5"/>
  <text x="400" y="515" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">
    Lambda Architecture Implementation
  </text>
  <text x="400" y="530" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-style="italic" fill="#666">
    Speed: Dataflow/Kinetics/Stream Analytics | Batch: BigQuery/Redshift/Synapse | Serving: Bigtable/DynamoDB/CosmosDB
  </text>
  
  <!-- Arrow markers -->
  <defs>
    <marker id="speedArrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#f5576c"/>
    </marker>
    <marker id="batchArrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#00f2fe"/>
    </marker>
  </defs>
</svg>